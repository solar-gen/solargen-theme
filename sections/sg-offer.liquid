{% comment %}
  SolarGen – Angebotsformular (nutzt Shopify's built-in "contact" form)
  - Versandt an die Shop-Kontaktadresse
  - Extra Felder werden im Mail-Body mitgesendet
{% endcomment %}

<style>
  @media (max-width: 768px) {
    .sg-offer-grid {
      grid-template-columns: 1fr !important;
      gap: 16px !important;
    }
    
    .sg-offer-container {
      padding: 0 16px !important;
    }
    
    .sg-offer-checkbox-grid {
      grid-template-columns: 1fr !important;
    }
  }
</style>

<section class="sg-offer">
  <div class="container sg-offer-container">
    <div class="layout">
      <div class="layout__section">
        
        <!-- Header -->
        <header style="margin-bottom: 30px;">
          <h1 style="font-size: 24px; font-weight: 600; color: #1f2937; margin: 0 0 20px 0; text-align: center;">Kontakt- und Angebotsanfrage</h1>
          
          <!-- Company Info Box -->
          <div style="margin: 20px 0; padding: 20px; background: #f8f9fa; border: 1px solid #e5e7eb; border-radius: 8px;">
            <h3 style="margin: 0 0 10px 0; font-size: 18px; font-weight: 600;">Solar-Gen®</h3>
            <p style="margin: 0 0 8px 0; font-size: 14px; color: #6b7280;"><strong>Adresse:</strong> Saarbrücker Str. 104a, 66359 Bous</p>
            <p style="margin: 0 0 8px 0; font-size: 14px; color: #6b7280;"><strong>Telefon:</strong> 06332 5004530</p>
            <p style="margin: 0 0 8px 0; font-size: 14px; color: #6b7280;"><strong>E-Mail:</strong> info@solar-gen.de</p>
            <p style="margin: 0 0 0 0; font-style: italic; font-size: 14px; color: #6b7280; line-height: 1.5;">Sie sind nicht sicher ob die ausgewählten Komponenten zu Ihrem Projekt passen? Dann fragen Sie unsere Experten um Rat. Unser Team steht Ihnen telefonisch oder per E-Mail zur Seite.</p>
          </div>
        </header>

        {% form 'contact', id: 'OfferForm', class: 'sg-offer__form' %}
          {% if form.posted_successfully? %}
            <div style="padding: 12px 16px; border: 1px solid #10b981; background: #ecfdf5; margin-bottom: 20px; font-size: 14px; color: #065f46; border-radius: 4px;" role="status">
              ✅ Danke! Wir haben Ihre Anfrage erhalten und melden uns zeitnah.
            </div>
          {% elsif form.errors %}
            <div style="padding: 12px 16px; border: 1px solid #ef4444; background: #fef2f2; margin-bottom: 20px; font-size: 14px; color: #991b1b; border-radius: 4px;" role="alert">
              Bitte prüfen: {{ form.errors | default_errors }}
            </div>
          {% endif %}

          <input type="hidden" name="form_type" value="contact">
          <input type="hidden" name="contact[tags]" value="angebot, lead">
          <input type="hidden" name="contact[subject]" value="Angebotsanfrage über Website">
          <input type="text" name="contact[company_website]" tabindex="-1" autocomplete="off" style="position: absolute; left: -9999px;" aria-hidden="true">

          <!-- Form Grid - Optimiertes Layout (wie Contact-Formular) -->
          <div class="sg-offer-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
            <!-- Left Column -->
            <div style="display: flex; flex-direction: column;">
              <label for="of-name" style="font-size: 14px; font-weight: 600; margin-bottom: 6px; color: #374151;">Vor- und Nachname*</label>
              <input id="of-name" type="text" name="contact[name]" required style="padding: 12px; border: 1px solid #d1d5db; border-radius: 4px; background: #fff; font-size: 14px;" placeholder="Max Mustermann">
            </div>

            <!-- Right Column -->
            <div style="display: flex; flex-direction: column;">
              <label for="of-email" style="font-size: 14px; font-weight: 600; margin-bottom: 6px; color: #374151;">E-Mail*</label>
              <input id="of-email" type="email" name="contact[email]" required style="padding: 12px; border: 1px solid #d1d5db; border-radius: 4px; background: #fff; font-size: 14px;" placeholder="max@beispiel.de">
            </div>
          </div>

          <div class="sg-offer-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
            <!-- Left Column -->
            <div style="display: flex; flex-direction: column;">
              <label for="of-phone" style="font-size: 14px; font-weight: 600; margin-bottom: 6px; color: #374151;">Telefon*</label>
              <input id="of-phone" type="tel" name="contact[phone]" required style="padding: 12px; border: 1px solid #d1d5db; border-radius: 4px; background: #fff; font-size: 14px;" placeholder="06332 5004530">
            </div>

            <!-- Right Column -->
            <div style="display: flex; flex-direction: column;">
              <label for="of-firma" style="font-size: 14px; font-weight: 600; margin-bottom: 6px; color: #374151;">Firma (optional)</label>
              <input id="of-firma" type="text" name="contact[company]" style="padding: 12px; border: 1px solid #d1d5db; border-radius: 4px; background: #fff; font-size: 14px;" placeholder="Musterfirma GmbH">
            </div>
          </div>

          <!-- Interesse Section -->
          <div style="margin-bottom: 20px;">
            <label style="font-size: 14px; font-weight: 600; margin-bottom: 6px; color: #374151; display: block;">Interesse an *</label>
            <div class="sg-offer-checkbox-grid" style="display: flex; flex-wrap: wrap; gap: 8px;">
              {% assign options = "Balkonkraftwerk,Solarmodule,Wechselrichter,Speicher,Komplettsets,Unterkonstruktion,Beratung,Montageservice" | split: "," %}
              {% for o in options %}
                <label style="display: flex; align-items: center; gap: 6px; border: 1px solid #d1d5db; background: #f9fafb; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 14px;">
                  <input type="checkbox" name="contact[interesse][]" value="{{ o | escape }}" required style="accent-color: #3b82f6;">
                  <span>{{ o }}</span>
                </label>
              {% endfor %}
            </div>
          </div>

          <div class="sg-offer-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
            <!-- Left Column -->
            <div style="display: flex; flex-direction: column;">
              <label for="of-standort" style="font-size: 14px; font-weight: 600; margin-bottom: 6px; color: #374151;">PLZ / Ort</label>
              <input id="of-standort" type="text" name="contact[standort]" style="padding: 12px; border: 1px solid #d1d5db; border-radius: 4px; background: #fff; font-size: 14px;" placeholder="z. B. 66359 Bous">
            </div>

            <!-- Right Column -->
            <div style="display: flex; flex-direction: column;">
              <label for="of-dach" style="font-size: 14px; font-weight: 600; margin-bottom: 6px; color: #374151;">Dachtyp</label>
              <select id="of-dach" name="contact[dachtyp]" style="padding: 12px; border: 1px solid #d1d5db; border-radius: 4px; background: #fff; font-size: 14px;">
                <option value="">Bitte wählen</option>
                <option>Satteldach</option>
                <option>Flachdach</option>
                <option>Fassade/Balkon</option>
                <option>Garage/Carport</option>
              </select>
            </div>
          </div>

          <div class="sg-offer-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
            <!-- Left Column -->
            <div style="display: flex; flex-direction: column;">
              <label for="of-leistung" style="font-size: 14px; font-weight: 600; margin-bottom: 6px; color: #374151;">Gewünschte Leistung</label>
              <select id="of-leistung" name="contact[leistung]" style="padding: 12px; border: 1px solid #d1d5db; border-radius: 4px; background: #fff; font-size: 14px;">
                <option value="">Bitte wählen</option>
                <option>bis 0,8 kWp (Balkon)</option>
                <option>1–5 kWp</option>
                <option>5–10 kWp</option>
                <option>10+ kWp</option>
              </select>
            </div>

            <!-- Right Column -->
            <div style="display: flex; flex-direction: column;">
              <label for="of-budget" style="font-size: 14px; font-weight: 600; margin-bottom: 6px; color: #374151;">Budgetrahmen</label>
              <select id="of-budget" name="contact[budget]" style="padding: 12px; border: 1px solid #d1d5db; border-radius: 4px; background: #fff; font-size: 14px;">
                <option value="">Keine Angabe</option>
                <option>bis 1.000 €</option>
                <option>1.000–3.000 €</option>
                <option>3.000–7.000 €</option>
                <option>über 7.000 €</option>
              </select>
            </div>
          </div>

          <!-- Nachricht - Großes Textarea -->
          <div style="margin-bottom: 20px;">
            <label for="of-msg" style="font-size: 14px; font-weight: 600; margin-bottom: 6px; color: #374151; display: block;">Ihre Nachricht</label>
            <textarea id="of-msg" name="contact[body]" rows="8" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 4px; background: #fff; font-size: 14px; resize: vertical; min-height: 120px;" placeholder="Weitere Angaben zu Ihrem Vorhaben (Besonderheiten, gewünschter Zeitrahmen, etc.)"></textarea>
          </div>

          {% if section.settings.show_consent %}
          <!-- DSGVO -->
          <div style="margin-bottom: 24px;">
            <label style="display: flex; align-items: flex-start; gap: 8px; font-size: 13px; line-height: 1.4; color: #6b7280;">
              <input type="checkbox" name="contact[consent]" required style="margin-top: 2px; width: 16px; height: 16px; accent-color: #3b82f6;">
              <span>Ich bin damit einverstanden, dass meine angegebenen Daten zum Zwecke der Bearbeitung meiner Anfrage gespeichert und zur Kontaktaufnahme durch Mitarbeiter genutzt werden. Eine Weitergabe an Dritte erfolgt nicht. Meine Einverständniserklärung kann ich jederzeit und kostenfrei durch eine E-Mail an info@solar-gen.de widerrufen.</span>
            </label>
          </div>
          {% endif %}

          <div style="margin-bottom: 16px;">
            <button type="submit" class="form__submit button button--primary button--min-width">Angebot anfordern</button>
          </div>
          <p style="margin: 0; color: #6b7280; font-size: 14px;">Oder rufen Sie uns an: <strong>06332 5004530</strong> (Mo–Fr 9–16&nbsp;Uhr)</p>
        {% endform %}
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "SG Angebotsformular",
  "settings": [
    {
      "type": "text",
      "id": "headline",
      "label": "Überschrift",
      "default": "Experten beraten Sie!"
    },
    {
      "type": "textarea",
      "id": "subline",
      "label": "Untertitel",
      "default": "Sie sind nicht sicher ob die ausgewählten Komponenten zu Ihrem Projekt passen? Dann fragen Sie unsere Experten um Rat. Unser Team steht Ihnen telefonisch oder per E-Mail zur Seite."
    },
    {
      "type": "checkbox",
      "id": "show_consent",
      "label": "DSGVO-Einverständnis anzeigen",
      "default": true
    }
  ]
}
{% endschema %}